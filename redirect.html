<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/@azure/msal-browser@5.1.0/lib/msal-browser.min.js"></script>
    <script>
      window.onload = function() {
        document.body.innerHTML = 'opener: ' + (window.opener ? 'EXISTS' : 'NULL') + '<br>';
        document.body.innerHTML += 'URL: ' + window.location.href + '<br>';
        
        if (window.opener) {
          // Try manually posting back to parent
          window.opener.postMessage(window.location.href, '*');
          document.body.innerHTML += 'postMessage sent<br>';
        }

        const msalInstance = new msal.PublicClientApplication({
          auth: {
            clientId: "a863afd3-fd91-40e8-abed-ebab3bc1d7a2",
            authority: "https://login.microsoftonline.com/ba167cb8-0550-49b3-9a3f-5450b1f55f3f"
          }
        });
        msalInstance.initialize().then(() => {
          return msalInstance.handleRedirectPromise();
        }).then((result) => {
          document.body.innerHTML += 'Result: ' + JSON.stringify(result) + '<br>';
        }).catch((err) => {
          document.body.innerHTML += 'Error: ' + err.message + '<br>';
        });
      };
    </script>
  </head>
  <body>Loading...</body>
</html>
