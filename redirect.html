<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/@azure/msal-browser@5.1.0/lib/msal-browser.min.js"></script>
    <script>
      window.onload = function() {
        document.body.innerText = 'MSAL loaded, handling redirect...';
        const msalInstance = new msal.PublicClientApplication({
          auth: {
            clientId: "a863afd3-fd91-40e8-abed-ebab3bc1d7a2",
            authority: "https://login.microsoftonline.com/ba167cb8-0550-49b3-9a3f-5450b1f55f3f"
          }
        });
        msalInstance.initialize().then(() => {
          document.body.innerText = 'Initialized, calling handleRedirectPromise...';
          return msalInstance.handleRedirectPromise();
        }).then((result) => {
          document.body.innerText = 'Result: ' + JSON.stringify(result);
        }).catch((err) => {
          document.body.innerText = 'Error: ' + err.message;
        });
      };
    </script>
  </head>
  <body>Loading...</body>
</html>
